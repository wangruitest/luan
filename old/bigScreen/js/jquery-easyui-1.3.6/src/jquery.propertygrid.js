(function(d){var b;function e(h){var g=d.data(h,"propertygrid");var f=d.data(h,"propertygrid").options;d(h).datagrid(d.extend({},f,{cls:"propertygrid",view:(f.showGroup?f.groupView:f.view),onClickRow:function(j,k){if(b!=this){c(b);b=this}if(f.editIndex!=j&&k.editor){var i=d(this).datagrid("getColumnOption","value");i.editor=k.editor;c(b);d(this).datagrid("beginEdit",j);d(this).datagrid("getEditors",j)[0].target.focus();f.editIndex=j}f.onClickRow.call(h,j,k)},loadFilter:function(i){c(this);return f.loadFilter.call(this,i)}}));d(document).unbind(".propertygrid").bind("mousedown.propertygrid",function(j){var i=d(j.target).closest("div.datagrid-view,div.combo-panel");if(i.length){return}c(b);b=undefined})}function c(j){var h=d(j);if(!h.length){return}var i=d.data(j,"propertygrid").options;var g=i.editIndex;if(g==undefined){return}var f=h.datagrid("getEditors",g)[0];if(f){f.target.blur();if(h.datagrid("validateRow",g)){h.datagrid("endEdit",g)}else{h.datagrid("cancelEdit",g)}}i.editIndex=undefined}d.fn.propertygrid=function(f,g){if(typeof f=="string"){var h=d.fn.propertygrid.methods[f];if(h){return h(this,g)}else{return this.datagrid(f,g)}}f=f||{};return this.each(function(){var j=d.data(this,"propertygrid");if(j){d.extend(j.options,f)}else{var i=d.extend({},d.fn.propertygrid.defaults,d.fn.propertygrid.parseOptions(this),f);i.frozenColumns=d.extend(true,[],i.frozenColumns);i.columns=d.extend(true,[],i.columns);d.data(this,"propertygrid",{options:i})}e(this)})};d.fn.propertygrid.methods={options:function(f){return d.data(f[0],"propertygrid").options}};d.fn.propertygrid.parseOptions=function(f){return d.extend({},d.fn.datagrid.parseOptions(f),d.parser.parseOptions(f,[{showGroup:"boolean"}]))};var a=d.extend({},d.fn.datagrid.defaults.view,{render:function(l,g,k){var j=[];var f=this.groups;for(var h=0;h<f.length;h++){j.push(this.renderGroup.call(this,l,h,f[h],k))}d(g).html(j.join(""))},renderGroup:function(q,s,r,f){var i=d.data(q,"datagrid");var g=i.options;var o=d(q).datagrid("getColumnFields",f);var u=[];u.push('<div class="datagrid-group" group-index='+s+">");u.push('<table cellspacing="0" cellpadding="0" border="0" style="height:100%"><tbody>');u.push("<tr>");if((f&&(g.rownumbers||g.frozenColumns.length))||(!f&&!(g.rownumbers||g.frozenColumns.length))){u.push('<td style="border:0;text-align:center;width:25px"><span class="datagrid-row-expander datagrid-row-collapse" style="display:inline-block;width:16px;height:16px;cursor:pointer">&nbsp;</span></td>')}u.push('<td style="border:0;">');if(!f){u.push('<span class="datagrid-group-title">');u.push(g.groupFormatter.call(q,r.value,r.rows));u.push("</span>")}u.push("</td>");u.push("</tr>");u.push("</tbody></table>");u.push("</div>");u.push('<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>');var p=r.startIndex;for(var m=0;m<r.rows.length;m++){var n=g.rowStyler?g.rowStyler.call(q,p,r.rows[m]):"";var k="";var v="";if(typeof n=="string"){v=n}else{if(n){k=n["class"]||"";v=n.style||""}}var t='class="datagrid-row '+(p%2&&g.striped?"datagrid-row-alt ":" ")+k+'"';var h=v?'style="'+v+'"':"";var l=i.rowIdPrefix+"-"+(f?1:2)+"-"+p;u.push('<tr id="'+l+'" datagrid-row-index="'+p+'" '+t+" "+h+">");u.push(this.renderRow.call(this,q,o,f,p,r.rows[m]));u.push("</tr>");p++}u.push("</tbody></table>");return u.join("")},bindEvents:function(i){var h=d.data(i,"datagrid");var g=h.dc;var f=g.body1.add(g.body2);var j=(d.data(f[0],"events")||d._data(f[0],"events")).click[0].handler;f.unbind("click").bind("click",function(m){var l=d(m.target);var n=l.closest("span.datagrid-row-expander");if(n.length){var k=n.closest("div.datagrid-group").attr("group-index");if(n.hasClass("datagrid-row-collapse")){d(i).datagrid("collapseGroup",k)}else{d(i).datagrid("expandGroup",k)}}else{j(m)}m.stopPropagation()})},onBeforeRender:function(o,s){var g=d.data(o,"datagrid");var f=g.options;p();var h=[];for(var k=0;k<s.length;k++){var r=s[k];var q=j(r[f.groupField]);if(!q){q={value:r[f.groupField],rows:[r]};h.push(q)}else{q.rows.push(r)}}var n=0;var m=[];for(var k=0;k<h.length;k++){var q=h[k];q.startIndex=n;n+=q.rows.length;m=m.concat(q.rows)}g.data.rows=m;this.groups=h;var l=this;setTimeout(function(){l.bindEvents(o)},0);function j(u){for(var t=0;t<h.length;t++){var v=h[t];if(v.value==u){return v}}return null}function p(){if(!d("#datagrid-group-style").length){d("head").append('<style id="datagrid-group-style">.datagrid-group{height:25px;overflow:hidden;font-weight:bold;border-bottom:1px solid #ccc;}</style>')}}}});d.extend(d.fn.datagrid.methods,{expandGroup:function(g,f){return g.each(function(){var h=d.data(this,"datagrid").dc.view;var i=h.find(f!=undefined?'div.datagrid-group[group-index="'+f+'"]':"div.datagrid-group");var j=i.find("span.datagrid-row-expander");if(j.hasClass("datagrid-row-expand")){j.removeClass("datagrid-row-expand").addClass("datagrid-row-collapse");i.next("table").show()}d(this).datagrid("fixRowHeight")})},collapseGroup:function(g,f){return g.each(function(){var h=d.data(this,"datagrid").dc.view;var i=h.find(f!=undefined?'div.datagrid-group[group-index="'+f+'"]':"div.datagrid-group");var j=i.find("span.datagrid-row-expander");if(j.hasClass("datagrid-row-collapse")){j.removeClass("datagrid-row-collapse").addClass("datagrid-row-expand");i.next("table").hide()}d(this).datagrid("fixRowHeight")})}});d.fn.propertygrid.defaults=d.extend({},d.fn.datagrid.defaults,{singleSelect:true,remoteSort:false,fitColumns:true,loadMsg:"",frozenColumns:[[{field:"f",width:16,resizable:false}]],columns:[[{field:"name",title:"Name",width:100,sortable:true},{field:"value",title:"Value",width:100,resizable:false}]],showGroup:false,groupView:a,groupField:"group",groupFormatter:function(f,g){return f}})})(jQuery);