(function(d){function f(m){var l=d.data(m.data.target,"draggable");var k=l.options;var j=l.proxy;var i=m.data;var h=i.startLeft+m.pageX-i.startX;var g=i.startTop+m.pageY-i.startY;if(j){if(j.parent()[0]==document.body){if(k.deltaX!=null&&k.deltaX!=undefined){h=m.pageX+k.deltaX}else{h=m.pageX-m.data.offsetWidth}if(k.deltaY!=null&&k.deltaY!=undefined){g=m.pageY+k.deltaY}else{g=m.pageY-m.data.offsetHeight}}else{if(k.deltaX!=null&&k.deltaX!=undefined){h+=m.data.offsetWidth+k.deltaX}if(k.deltaY!=null&&k.deltaY!=undefined){g+=m.data.offsetHeight+k.deltaY}}}if(m.data.parent!=document.body){h+=d(m.data.parent).scrollLeft();g+=d(m.data.parent).scrollTop()}if(k.axis=="h"){i.left=h}else{if(k.axis=="v"){i.top=g}else{i.left=h;i.top=g}}}function a(j){var g=d.data(j.data.target,"draggable");var i=g.options;var h=g.proxy;if(!h){h=d(j.data.target)}h.css({left:j.data.left,top:j.data.top});d("body").css("cursor",i.cursor)}function b(i){d.fn.draggable.isDragging=true;var h=d.data(i.data.target,"draggable");var g=h.options;var k=d(".droppable").filter(function(){return i.data.target!=this}).filter(function(){var l=d.data(this,"droppable").options.accept;if(l){return d(l).filter(function(){return this==i.data.target}).length>0}else{return true}});h.droppables=k;var j=h.proxy;if(!j){if(g.proxy){if(g.proxy=="clone"){j=d(i.data.target).clone().insertAfter(i.data.target)}else{j=g.proxy.call(i.data.target,i.data.target)}h.proxy=j}else{j=d(i.data.target)}}j.css("position","absolute");f(i);a(i);g.onStartDrag.call(i.data.target,i);return false}function e(i){var h=d.data(i.data.target,"draggable");f(i);if(h.options.onDrag.call(i.data.target,i)!=false){a(i)}var g=i.data.target;h.droppables.each(function(){var j=d(this);if(j.droppable("options").disabled){return}var k=j.offset();if(i.pageX>k.left&&i.pageX<k.left+j.outerWidth()&&i.pageY>k.top&&i.pageY<k.top+j.outerHeight()){if(!this.entered){d(this).trigger("_dragenter",[g]);this.entered=true}d(this).trigger("_dragover",[g])}else{if(this.entered){d(this).trigger("_dragleave",[g]);this.entered=false}}});return false}function c(n){d.fn.draggable.isDragging=false;e(n);var j=d.data(n.data.target,"draggable");var h=j.proxy;var g=j.options;if(g.revert){if(l()==true){d(n.data.target).css({position:n.data.startPosition,left:n.data.startLeft,top:n.data.startTop})}else{if(h){var k,m;if(h.parent()[0]==document.body){k=n.data.startX-n.data.offsetWidth;m=n.data.startY-n.data.offsetHeight}else{k=n.data.startLeft;m=n.data.startTop}h.animate({left:k,top:m},function(){i()})}else{d(n.data.target).animate({left:n.data.startLeft,top:n.data.startTop},function(){d(n.data.target).css("position",n.data.startPosition)})}}}else{d(n.data.target).css({position:"absolute",left:n.data.left,top:n.data.top});l()}g.onStopDrag.call(n.data.target,n);d(document).unbind(".draggable");setTimeout(function(){d("body").css("cursor","")},100);function i(){if(h){h.remove()}j.proxy=null}function l(){var o=false;j.droppables.each(function(){var p=d(this);if(p.droppable("options").disabled){return}var q=p.offset();if(n.pageX>q.left&&n.pageX<q.left+p.outerWidth()&&n.pageY>q.top&&n.pageY<q.top+p.outerHeight()){if(g.revert){d(n.data.target).css({position:n.data.startPosition,left:n.data.startLeft,top:n.data.startTop})}d(this).trigger("_drop",[n.data.target]);i();o=true;this.entered=false;return false}});if(!o&&!g.revert){i()}return o}return false}d.fn.draggable=function(g,h){if(typeof g=="string"){return d.fn.draggable.methods[g](this,h)}return this.each(function(){var i;var l=d.data(this,"draggable");if(l){l.handle.unbind(".draggable");i=d.extend(l.options,g)}else{i=d.extend({},d.fn.draggable.defaults,d.fn.draggable.parseOptions(this),g||{})}var k=i.handle?(typeof i.handle=="string"?d(i.handle,this):i.handle):d(this);d.data(this,"draggable",{options:i,handle:k});if(i.disabled){d(this).css("cursor","");return}k.unbind(".draggable").bind("mousemove.draggable",{target:this},function(n){if(d.fn.draggable.isDragging){return}var m=d.data(n.data.target,"draggable").options;if(j(n)){d(this).css("cursor",m.cursor)}else{d(this).css("cursor","")}}).bind("mouseleave.draggable",{target:this},function(m){d(this).css("cursor","")}).bind("mousedown.draggable",{target:this},function(q){if(j(q)==false){return}d(this).css("cursor","");var p=d(q.data.target).position();var o=d(q.data.target).offset();var n={startPosition:d(q.data.target).css("position"),startLeft:p.left,startTop:p.top,left:p.left,top:p.top,startX:q.pageX,startY:q.pageY,offsetWidth:(q.pageX-o.left),offsetHeight:(q.pageY-o.top),target:q.data.target,parent:d(q.data.target).parent()[0]};d.extend(q.data,n);var m=d.data(q.data.target,"draggable").options;if(m.onBeforeDrag.call(q.data.target,q)==false){return}d(document).bind("mousedown.draggable",q.data,b);d(document).bind("mousemove.draggable",q.data,e);d(document).bind("mouseup.draggable",q.data,c)});function j(p){var m=d.data(p.data.target,"draggable");var x=m.handle;var v=d(x).offset();var u=d(x).outerWidth();var s=d(x).outerHeight();var w=p.pageY-v.top;var n=v.left+u-p.pageX;var q=v.top+s-p.pageY;var o=p.pageX-v.left;return Math.min(w,n,q,o)>m.options.edge}})};d.fn.draggable.methods={options:function(g){return d.data(g[0],"draggable").options},proxy:function(g){return d.data(g[0],"draggable").proxy},enable:function(g){return g.each(function(){d(this).draggable({disabled:false})})},disable:function(g){return g.each(function(){d(this).draggable({disabled:true})})}};d.fn.draggable.parseOptions=function(g){var h=d(g);return d.extend({},d.parser.parseOptions(g,["cursor","handle","axis",{revert:"boolean",deltaX:"number",deltaY:"number",edge:"number"}]),{disabled:(h.attr("disabled")?true:undefined)})};d.fn.draggable.defaults={proxy:null,revert:false,cursor:"move",deltaX:null,deltaY:null,handle:null,disabled:false,edge:0,axis:null,onBeforeDrag:function(g){},onStartDrag:function(g){},onDrag:function(g){},onStopDrag:function(g){}};d.fn.draggable.isDragging=false})(jQuery);