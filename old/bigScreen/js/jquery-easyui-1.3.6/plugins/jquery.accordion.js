(function(i){function n(y){var x=i.data(y,"accordion");var w=x.options;var v=x.panels;var q=i(y);w.fit?i.extend(w,q._fit()):q._fit(false);if(!isNaN(w.width)){q._outerWidth(w.width)}else{q.css("width","")}var u=0;var t="auto";var s=q.find(">div.panel>div.accordion-header");if(s.length){u=i(s[0]).css("height","")._outerHeight()}if(!isNaN(w.height)){q._outerHeight(w.height);t=q.height()-u*s.length}else{q.css("height","")}r(true,t-r(false)+1);function r(D,B){var A=0;for(var C=0;C<v.length;C++){var F=v[C];var E=F.panel("header")._outerHeight(u);if(F.panel("options").collapsible==D){var z=isNaN(B)?undefined:(B+u*E.length);F.panel("resize",{width:q.width(),height:(D?z:undefined)});A+=F.panel("panel").outerHeight()-u}}return A}}function j(x,w,v,s){var u=i.data(x,"accordion").panels;var q=[];for(var r=0;r<u.length;r++){var t=u[r];if(w){if(t.panel("options")[w]==v){q.push(t)}}else{if(t[0]==i(v)[0]){return r}}}if(w){return s?q:(q.length?q[0]:null)}else{return -1}}function f(q){return j(q,"collapsed",false,true)}function e(r){var q=f(r);return q.length?q[0]:null}function c(r,q){return j(r,null,q)}function g(s,r){var q=i.data(s,"accordion").panels;if(typeof r=="number"){if(r<0||r>=q.length){return null}else{return q[r]}}return j(s,"title",r)}function d(q){var r=i.data(q,"accordion").options;var s=i(q);if(r.border){s.removeClass("accordion-noborder")}else{s.addClass("accordion-noborder")}}function a(s){var q=i.data(s,"accordion");var r=i(s);r.addClass("accordion");q.panels=[];r.children("div").each(function(){var u=i.extend({},i.parser.parseOptions(this),{selected:(i(this).attr("selected")?true:undefined)});var t=i(this);q.panels.push(t);o(s,t,u)});r.bind("_resize",function(v,u){var t=i.data(s,"accordion").options;if(t.fit==true||u){n(s)}return false})}function o(w,q,s){var x=i.data(w,"accordion").options;q.panel(i.extend({},{collapsible:true,minimizable:false,maximizable:false,closable:false,doSize:false,collapsed:true,headerCls:"accordion-header",bodyCls:"accordion-body"},s,{onBeforeExpand:function(){if(s.onBeforeExpand){if(s.onBeforeExpand.call(this)==false){return false}}if(!x.multiple){var y=i.grep(f(w),function(A){return A.panel("options").collapsible});for(var t=0;t<y.length;t++){k(w,c(w,y[t]))}}var z=i(this).panel("header");z.addClass("accordion-header-selected");z.find(".accordion-collapse").removeClass("accordion-expand")},onExpand:function(){if(s.onExpand){s.onExpand.call(this)}x.onSelect.call(w,i(this).panel("options").title,c(w,this))},onBeforeCollapse:function(){if(s.onBeforeCollapse){if(s.onBeforeCollapse.call(this)==false){return false}}var t=i(this).panel("header");t.removeClass("accordion-header-selected");t.find(".accordion-collapse").addClass("accordion-expand")},onCollapse:function(){if(s.onCollapse){s.onCollapse.call(this)}x.onUnselect.call(w,i(this).panel("options").title,c(w,this))}}));var v=q.panel("header");var r=v.children("div.panel-tool");r.children("a.panel-tool-collapse").hide();var u=i('<a href="javascript:void(0)"></a>').addClass("accordion-collapse accordion-expand").appendTo(r);u.bind("click",function(){var t=c(w,q);if(q.panel("options").collapsed){m(w,t)}else{k(w,t)}return false});q.panel("options").collapsible?u.show():u.hide();v.click(function(){i(this).find("a.accordion-collapse:visible").triggerHandler("click");return false})}function m(r,q){var s=g(r,q);if(!s){return}l(r);var t=i.data(r,"accordion").options;s.panel("expand",t.animate)}function k(t,r){var s=g(t,r);if(!s){return}l(t);var q=i.data(t,"accordion").options;s.panel("collapse",q.animate)}function h(t){var s=i.data(t,"accordion").options;var r=j(t,"selected",true);if(r){q(c(t,r))}else{q(s.selected)}function q(v){var u=s.animate;s.animate=false;m(t,v);s.animate=u}}function l(r){var s=i.data(r,"accordion").panels;for(var q=0;q<s.length;q++){s[q].stop(true,true)}}function p(v,u){var t=i.data(v,"accordion");var s=t.options;var q=t.panels;if(u.selected==undefined){u.selected=true}l(v);var r=i("<div></div>").appendTo(v);q.push(r);o(v,r,u);n(v);s.onAdd.call(v,u.title,q.length-1);if(u.selected){m(v,q.length-1)}}function b(t,s){var q=i.data(t,"accordion");var y=q.options;var x=q.panels;l(t);var w=g(t,s);var v=w.panel("options").title;var u=c(t,w);if(!w){return}if(y.onBeforeRemove.call(t,v,u)==false){return}x.splice(u,1);w.panel("destroy");if(x.length){n(t);var r=e(t);if(!r){m(t,0)}}y.onRemove.call(t,v,u)}i.fn.accordion=function(r,q){if(typeof r=="string"){return i.fn.accordion.methods[r](this,q)}r=r||{};return this.each(function(){var s=i.data(this,"accordion");if(s){i.extend(s.options,r)}else{i.data(this,"accordion",{options:i.extend({},i.fn.accordion.defaults,i.fn.accordion.parseOptions(this),r),accordion:i(this).addClass("accordion"),panels:[]});a(this)}d(this);n(this);h(this)})};i.fn.accordion.methods={options:function(q){return i.data(q[0],"accordion").options},panels:function(q){return i.data(q[0],"accordion").panels},resize:function(q){return q.each(function(){n(this)})},getSelections:function(q){return f(q[0])},getSelected:function(q){return e(q[0])},getPanel:function(r,q){return g(r[0],q)},getPanelIndex:function(r,q){return c(r[0],q)},select:function(r,q){return r.each(function(){m(this,q)})},unselect:function(r,q){return r.each(function(){k(this,q)})},add:function(r,q){return r.each(function(){p(this,q)})},remove:function(r,q){return r.each(function(){b(this,q)})}};i.fn.accordion.parseOptions=function(r){var q=i(r);return i.extend({},i.parser.parseOptions(r,["width","height",{fit:"boolean",border:"boolean",animate:"boolean",multiple:"boolean",selected:"number"}]))};i.fn.accordion.defaults={width:"auto",height:"auto",fit:false,border:true,animate:true,multiple:false,selected:0,onSelect:function(r,q){},onUnselect:function(q,r){},onAdd:function(r,q){},onBeforeRemove:function(r,q){},onRemove:function(r,q){}}})(jQuery);