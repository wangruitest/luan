(function(e){function f(h){var g=e.data(h,"timespinner").options;e(h).addClass("timespinner-f");e(h).spinner(g);e(h).unbind(".timespinner");e(h).bind("click.timespinner",function(){var k=0;if(this.selectionStart!=null){k=this.selectionStart}else{if(this.createTextRange){var i=h.createTextRange();var j=document.selection.createRange();j.setEndPoint("StartToStart",i);k=j.text.length}}if(k>=0&&k<=2){g.highlight=0}else{if(k>=3&&k<=5){g.highlight=1}else{if(k>=6&&k<=8){g.highlight=2}}}c(h)}).bind("blur.timespinner",function(){d(h)})}function c(h){var g=e.data(h,"timespinner").options;var k=0,j=0;if(g.highlight==0){k=0;j=2}else{if(g.highlight==1){k=3;j=5}else{if(g.highlight==2){k=6;j=8}}}if(h.selectionStart!=null){h.setSelectionRange(k,j)}else{if(h.createTextRange){var i=h.createTextRange();i.collapse();i.moveEnd("character",j);i.moveStart("character",k);i.select()}}e(h).focus()}function b(g,l){var k=e.data(g,"timespinner").options;if(!l){return null}var j=l.split(k.separator);for(var h=0;h<j.length;h++){if(isNaN(j[h])){return null}}while(j.length<3){j.push(0)}return new Date(1900,0,0,j[0],j[1],j[2])}function d(n){var m=e.data(n,"timespinner").options;var l=e(n).val();var k=b(n,l);if(!k){m.value="";e(n).spinner("setValue","");return}var j=b(n,m.min);var i=b(n,m.max);if(j&&j>k){k=j}if(i&&i<k){k=i}var o=[g(k.getHours()),g(k.getMinutes())];if(m.showSeconds){o.push(g(k.getSeconds()))}var h=o.join(m.separator);m.value=h;e(n).spinner("setValue",h);function g(p){return(p<10?"0":"")+p}}function a(k,j){var g=e.data(k,"timespinner").options;var m=e(k).val();if(m==""){m=[0,0,0].join(g.separator)}var l=m.split(g.separator);for(var h=0;h<l.length;h++){l[h]=parseInt(l[h],10)}if(j==true){l[g.highlight]-=g.increment}else{l[g.highlight]+=g.increment}e(k).val(l.join(g.separator));d(k);c(k)}e.fn.timespinner=function(i,h){if(typeof i=="string"){var g=e.fn.timespinner.methods[i];if(g){return g(this,h)}else{return this.spinner(i,h)}}i=i||{};return this.each(function(){var j=e.data(this,"timespinner");if(j){e.extend(j.options,i)}else{e.data(this,"timespinner",{options:e.extend({},e.fn.timespinner.defaults,e.fn.timespinner.parseOptions(this),i)})}f(this)})};e.fn.timespinner.methods={options:function(h){var g=e.data(h[0],"timespinner").options;return e.extend(g,{value:h.val(),originalValue:h.spinner("options").originalValue})},setValue:function(h,g){return h.each(function(){e(this).val(g);d(this)})},getHours:function(i){var h=e.data(i[0],"timespinner").options;var g=i.val().split(h.separator);return parseInt(g[0],10)},getMinutes:function(i){var h=e.data(i[0],"timespinner").options;var g=i.val().split(h.separator);return parseInt(g[1],10)},getSeconds:function(i){var h=e.data(i[0],"timespinner").options;var g=i.val().split(h.separator);return parseInt(g[2],10)||0}};e.fn.timespinner.parseOptions=function(g){return e.extend({},e.fn.spinner.parseOptions(g),e.parser.parseOptions(g,["separator",{showSeconds:"boolean",highlight:"number"}]))};e.fn.timespinner.defaults=e.extend({},e.fn.spinner.defaults,{separator:":",showSeconds:false,highlight:0,spin:function(g){a(this,g)}})})(jQuery);