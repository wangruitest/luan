(function(d){function e(h){var g=d('<span class="spinner"><span class="spinner-arrow"><span class="spinner-arrow-up"></span><span class="spinner-arrow-down"></span></span></span>').insertAfter(h);d(h).addClass("spinner-text spinner-f").prependTo(g);return g}function b(l,j){var i=d.data(l,"spinner").options;var h=d.data(l,"spinner").spinner;if(j){i.width=j}var g=d('<div style="display:none"></div>').insertBefore(h);h.appendTo("body");if(isNaN(i.width)){i.width=d(l).outerWidth()}var k=h.find(".spinner-arrow");h._outerWidth(i.width)._outerHeight(i.height);d(l)._outerWidth(h.width()-k.outerWidth());d(l).css({height:h.height()+"px",lineHeight:h.height()+"px"});k._outerHeight(h.height());k.find("span")._outerHeight(k.height()/2);h.insertAfter(g);g.remove()}function a(i){var h=d.data(i,"spinner").options;var g=d.data(i,"spinner").spinner;d(i).unbind(".spinner");g.find(".spinner-arrow-up,.spinner-arrow-down").unbind(".spinner");if(!h.disabled&&!h.readonly){g.find(".spinner-arrow-up").bind("mouseenter.spinner",function(){d(this).addClass("spinner-arrow-hover")}).bind("mouseleave.spinner",function(){d(this).removeClass("spinner-arrow-hover")}).bind("click.spinner",function(){h.spin.call(i,false);h.onSpinUp.call(i);d(i).validatebox("validate")});g.find(".spinner-arrow-down").bind("mouseenter.spinner",function(){d(this).addClass("spinner-arrow-hover")}).bind("mouseleave.spinner",function(){d(this).removeClass("spinner-arrow-hover")}).bind("click.spinner",function(){h.spin.call(i,true);h.onSpinDown.call(i);d(i).validatebox("validate")});d(i).bind("change.spinner",function(){d(this).spinner("setValue",d(this).val())})}}function f(i,h){var g=d.data(i,"spinner").options;if(h){g.disabled=true;d(i).attr("disabled",true)}else{g.disabled=false;d(i).removeAttr("disabled")}}function c(k,j){var i=d.data(k,"spinner");var h=i.options;h.readonly=j==undefined?true:j;var g=h.readonly?true:(!h.editable);d(k).attr("readonly",g).css("cursor",g?"pointer":"")}d.fn.spinner=function(g,i){if(typeof g=="string"){var h=d.fn.spinner.methods[g];if(h){return h(this,i)}else{return this.validatebox(g,i)}}g=g||{};return this.each(function(){var j=d.data(this,"spinner");if(j){d.extend(j.options,g)}else{j=d.data(this,"spinner",{options:d.extend({},d.fn.spinner.defaults,d.fn.spinner.parseOptions(this),g),spinner:e(this)});d(this).removeAttr("disabled")}j.options.originalValue=j.options.value;d(this).val(j.options.value);f(this,j.options.disabled);c(this,j.options.readonly);b(this);d(this).validatebox(j.options);a(this)})};d.fn.spinner.methods={options:function(h){var g=d.data(h[0],"spinner").options;return d.extend(g,{value:h.val()})},destroy:function(g){return g.each(function(){var h=d.data(this,"spinner").spinner;d(this).validatebox("destroy");h.remove()})},resize:function(h,g){return h.each(function(){b(this,g)})},enable:function(g){return g.each(function(){f(this,false);a(this)})},disable:function(g){return g.each(function(){f(this,true);a(this)})},readonly:function(h,g){return h.each(function(){c(this,g);a(this)})},getValue:function(g){return g.val()},setValue:function(h,g){return h.each(function(){var j=d.data(this,"spinner").options;var i=j.value;j.value=g;d(this).val(g);if(i!=g){j.onChange.call(this,g,i)}})},clear:function(g){return g.each(function(){var h=d.data(this,"spinner").options;h.value="";d(this).val("")})},reset:function(g){return g.each(function(){var h=d(this).spinner("options");d(this).spinner("setValue",h.originalValue)})}};d.fn.spinner.parseOptions=function(h){var g=d(h);return d.extend({},d.fn.validatebox.parseOptions(h),d.parser.parseOptions(h,["width","height","min","max",{increment:"number",editable:"boolean"}]),{value:(g.val()||undefined),disabled:(g.attr("disabled")?true:undefined),readonly:(g.attr("readonly")?true:undefined)})};d.fn.spinner.defaults=d.extend({},d.fn.validatebox.defaults,{width:"auto",height:22,deltaX:19,value:"",min:null,max:null,increment:1,editable:true,disabled:false,readonly:false,spin:function(g){},onSpinUp:function(){},onSpinDown:function(){},onChange:function(h,g){}})})(jQuery);