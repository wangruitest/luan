(function(f){function g(l){var k=f.data(l,"calendar").options;var i=f(l);k.fit?f.extend(k,i._fit()):i._fit(false);var j=i.find(".calendar-header");i._outerWidth(k.width);i._outerHeight(k.height);i.find(".calendar-body")._outerHeight(i.height()-j._outerHeight())}function d(i){f(i).addClass("calendar").html('<div class="calendar-header"><div class="calendar-prevmonth"></div><div class="calendar-nextmonth"></div><div class="calendar-prevyear"></div><div class="calendar-nextyear"></div><div class="calendar-title"><span>Aprial 2010</span></div></div><div class="calendar-body"><div class="calendar-menu"><div class="calendar-menu-year-inner"><span class="calendar-menu-prev"></span><span><input class="calendar-menu-year" type="text"></input></span><span class="calendar-menu-next"></span></div><div class="calendar-menu-month-inner"></div></div></div>');f(i).find(".calendar-title span").hover(function(){f(this).addClass("calendar-menu-hover")},function(){f(this).removeClass("calendar-menu-hover")}).click(function(){var j=f(i).find(".calendar-menu");if(j.is(":visible")){j.hide()}else{e(i)}});f(".calendar-prevmonth,.calendar-nextmonth,.calendar-prevyear,.calendar-nextyear",i).hover(function(){f(this).addClass("calendar-nav-hover")},function(){f(this).removeClass("calendar-nav-hover")});f(i).find(".calendar-nextmonth").click(function(){b(i,1)});f(i).find(".calendar-prevmonth").click(function(){b(i,-1)});f(i).find(".calendar-nextyear").click(function(){h(i,1)});f(i).find(".calendar-prevyear").click(function(){h(i,-1)});f(i).bind("_resize",function(){var j=f.data(i,"calendar").options;if(j.fit==true){g(i)}return false})}function b(l,k){var j=f.data(l,"calendar").options;j.month+=k;if(j.month>12){j.year++;j.month=1}else{if(j.month<1){j.year--;j.month=12}}c(l);var i=f(l).find(".calendar-menu-month-inner");i.find("td.calendar-selected").removeClass("calendar-selected");i.find("td:eq("+(j.month-1)+")").addClass("calendar-selected")}function h(l,k){var j=f.data(l,"calendar").options;j.year+=k;c(l);var i=f(l).find(".calendar-menu-year");i.val(j.year)}function e(q){var p=f.data(q,"calendar").options;f(q).find(".calendar-menu").show();if(f(q).find(".calendar-menu-month-inner").is(":empty")){f(q).find(".calendar-menu-month-inner").empty();var w=f('<table class="calendar-mtable"></table>').appendTo(f(q).find(".calendar-menu-month-inner"));var v=0;for(var s=0;s<3;s++){var u=f("<tr></tr>").appendTo(w);for(var r=0;r<4;r++){f('<td class="calendar-menu-month"></td>').html(p.months[v++]).attr("abbr",v).appendTo(u)}}f(q).find(".calendar-menu-prev,.calendar-menu-next").hover(function(){f(this).addClass("calendar-menu-hover")},function(){f(this).removeClass("calendar-menu-hover")});f(q).find(".calendar-menu-next").click(function(){var i=f(q).find(".calendar-menu-year");if(!isNaN(i.val())){i.val(parseInt(i.val())+1);n()}});f(q).find(".calendar-menu-prev").click(function(){var i=f(q).find(".calendar-menu-year");if(!isNaN(i.val())){i.val(parseInt(i.val()-1));n()}});f(q).find(".calendar-menu-year").keypress(function(i){if(i.keyCode==13){n(true)}});f(q).find(".calendar-menu-month").hover(function(){f(this).addClass("calendar-menu-hover")},function(){f(this).removeClass("calendar-menu-hover")}).click(function(){var i=f(q).find(".calendar-menu");i.find(".calendar-selected").removeClass("calendar-selected");f(this).addClass("calendar-selected");n(true)})}function n(i){var x=f(q).find(".calendar-menu");var t=x.find(".calendar-menu-year").val();var j=x.find(".calendar-selected").attr("abbr");if(!isNaN(t)){p.year=parseInt(t);p.month=parseInt(j);c(q)}if(i){x.hide()}}var o=f(q).find(".calendar-body");var m=f(q).find(".calendar-menu");var l=m.find(".calendar-menu-year-inner");var k=m.find(".calendar-menu-month-inner");l.find("input").val(p.year).focus();k.find("td.calendar-selected").removeClass("calendar-selected");k.find("td:eq("+(p.month-1)+")").addClass("calendar-selected");m._outerWidth(o._outerWidth());m._outerHeight(o._outerHeight());k._outerHeight(m.height()-l._outerHeight())}function a(l,k,y){var w=f.data(l,"calendar").options;var u=[];var s=new Date(k,y,0).getDate();for(var m=1;m<=s;m++){u.push([k,y,m])}var q=[],o=[];var j=-1;while(u.length>0){var x=u.shift();o.push(x);var n=new Date(x[0],x[1]-1,x[2]).getDay();if(j==n){n=0}else{if(n==(w.firstDay==0?7:w.firstDay)-1){q.push(o);o=[]}}j=n}if(o.length){q.push(o)}var v=q[0];if(v.length<7){while(v.length<7){var t=v[0];var x=new Date(t[0],t[1]-1,t[2]-1);v.unshift([x.getFullYear(),x.getMonth()+1,x.getDate()])}}else{var t=v[0];var o=[];for(var m=1;m<=7;m++){var x=new Date(t[0],t[1]-1,t[2]-m);o.unshift([x.getFullYear(),x.getMonth()+1,x.getDate()])}q.unshift(o)}var r=q[q.length-1];while(r.length<7){var p=r[r.length-1];var x=new Date(p[0],p[1]-1,p[2]+1);r.push([x.getFullYear(),x.getMonth()+1,x.getDate()])}if(q.length<6){var p=r[r.length-1];var o=[];for(var m=1;m<=7;m++){var x=new Date(p[0],p[1]-1,p[2]+m);o.push([x.getFullYear(),x.getMonth()+1,x.getDate()])}q.push(o)}return q}function c(H){var G=f.data(H,"calendar").options;if(G.current&&!G.validator.call(H,G.current)){G.current=null}var l=new Date();var D=l.getFullYear()+","+(l.getMonth()+1)+","+l.getDate();var C=G.current?(G.current.getFullYear()+","+(G.current.getMonth()+1)+","+G.current.getDate()):"";var A=6-G.firstDay;var y=A+1;if(A>=7){A-=7}if(y>=7){y-=7}f(H).find(".calendar-title span").html(G.months[G.month-1]+" "+G.year);var w=f(H).find("div.calendar-body");w.children("table").remove();var r=['<table class="calendar-dtable" cellspacing="0" cellpadding="0" border="0">'];r.push("<thead><tr>");for(var x=G.firstDay;x<G.weeks.length;x++){r.push("<th>"+G.weeks[x]+"</th>")}for(var x=0;x<G.firstDay;x++){r.push("<th>"+G.weeks[x]+"</th>")}r.push("</tr></thead>");r.push("<tbody>");var q=a(H,G.year,G.month);for(var x=0;x<q.length;x++){var p=q[x];var k="";if(x==0){k="calendar-first"}else{if(x==q.length-1){k="calendar-last"}}r.push('<tr class="'+k+'">');for(var u=0;u<p.length;u++){var v=p[u];var o=v[0]+","+v[1]+","+v[2];var E=new Date(v[0],parseInt(v[1])-1,v[2]);var F=G.formatter.call(H,E);var m=G.styler.call(H,E);var B="";var z="";if(typeof m=="string"){z=m}else{if(m){B=m["class"]||"";z=m.style||""}}var k="calendar-day";if(!(G.year==v[0]&&G.month==v[1])){k+=" calendar-other-month"}if(o==D){k+=" calendar-today"}if(o==C){k+=" calendar-selected"}if(u==A){k+=" calendar-saturday"}else{if(u==y){k+=" calendar-sunday"}}if(u==0){k+=" calendar-first"}else{if(u==p.length-1){k+=" calendar-last"}}k+=" "+B;if(!G.validator.call(H,E)){k+=" calendar-disabled"}r.push('<td class="'+k+'" abbr="'+o+'" style="'+z+'">'+F+"</td>")}r.push("</tr>")}r.push("</tbody>");r.push("</table>");w.append(r.join(""));var n=w.children("table.calendar-dtable").prependTo(w);n.find("td.calendar-day:not(.calendar-disabled)").hover(function(){f(this).addClass("calendar-hover")},function(){f(this).removeClass("calendar-hover")}).click(function(){var j=G.current;n.find(".calendar-selected").removeClass("calendar-selected");f(this).addClass("calendar-selected");var i=f(this).attr("abbr").split(",");G.current=new Date(i[0],parseInt(i[1])-1,i[2]);G.onSelect.call(H,G.current);if(!j||j.getTime()!=G.current.getTime()){G.onChange.call(H,G.current,j)}})}f.fn.calendar=function(i,j){if(typeof i=="string"){return f.fn.calendar.methods[i](this,j)}i=i||{};return this.each(function(){var k=f.data(this,"calendar");if(k){f.extend(k.options,i)}else{k=f.data(this,"calendar",{options:f.extend({},f.fn.calendar.defaults,f.fn.calendar.parseOptions(this),i)});d(this)}if(k.options.border==false){f(this).addClass("calendar-noborder")}g(this);c(this);f(this).find("div.calendar-menu").hide()})};f.fn.calendar.methods={options:function(i){return f.data(i[0],"calendar").options},resize:function(i){return i.each(function(){g(this)})},moveTo:function(j,i){return j.each(function(){var l=f(this).calendar("options");if(l.validator.call(this,i)){var k=l.current;f(this).calendar({year:i.getFullYear(),month:i.getMonth()+1,current:i});if(!k||k.getTime()!=i.getTime()){l.onChange.call(this,l.current,k)}}})}};f.fn.calendar.parseOptions=function(i){var j=f(i);return f.extend({},f.parser.parseOptions(i,["width","height",{firstDay:"number",fit:"boolean",border:"boolean"}]))};f.fn.calendar.defaults={width:180,height:180,fit:false,border:true,firstDay:0,weeks:["S","M","T","W","T","F","S"],months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],year:new Date().getFullYear(),month:new Date().getMonth()+1,current:(function(){var i=new Date();return new Date(i.getFullYear(),i.getMonth(),i.getDate())})(),formatter:function(i){return i.getDate()},styler:function(i){return""},validator:function(i){return true},onSelect:function(i){},onChange:function(i,j){}}})(jQuery);