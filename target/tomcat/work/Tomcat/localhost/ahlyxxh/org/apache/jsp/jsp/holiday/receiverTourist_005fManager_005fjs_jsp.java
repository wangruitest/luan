/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.37
 * Generated at: 2017-09-11 02:06:34 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.jsp.holiday;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.funo.report.*;
import com.funo.utils.Constants;
import com.funo.report.charts.ReportConstants;
import com.funo.system.model.SysOperator;

public final class receiverTourist_005fManager_005fjs_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("<!DOCTYPE html>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
 
SysOperator user = null;
    if (request.getSession() != null && request.getSession().getAttribute(Constants.Session_Attribute_UserEnv) != null) {
        user = (SysOperator) request.getSession().getAttribute(Constants.Session_Attribute_UserEnv);
    }
    String curCountyCode = "";
    if (null != user.getCountyCode()) {
    	curCountyCode = user.getCountyCode();
    }

      out.write("\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("    var queryFormCach = null;\r\n");
      out.write("    var treeSelectCach = null;\r\n");
      out.write("    $(function () {\r\n");
      out.write("    \t\r\n");
      out.write("    \t //创建列表\r\n");
      out.write("        $(\"#gridbox\").datagrid({\r\n");
      out.write("            title:'节假日景区游客接待统计',\r\n");
      out.write("            idField: 'id',\r\n");
      out.write("            singleSelect: false,\r\n");
      out.write("            pagination: true,\r\n");
      out.write("            rownumbers:true,\r\n");
      out.write("            height:getViewportHeight()-80,\r\n");
      out.write("            pageSize: 30,\r\n");
      out.write("            border:false,\r\n");
      out.write("            fitColumns: true,\r\n");
      out.write("            columns: [[\r\n");
      out.write("                {field: 'REGIONNAME', title: '景区名称', width: 100},\r\n");
      out.write("                {field: 'SUMVISTOTAL', title: '游客接待总量（人数）', width: 60},\r\n");
      out.write("                {field: 'HOLIDAYNAME', title: '假日名称', width: 50},\r\n");
      out.write("                {field: 'FIRSTDAY',title :'开始日期',width :100},\r\n");
      out.write("                {field: 'HOLIDAYLASTDATE',title :'结束日期',width :100}\r\n");
      out.write("            ]]\r\n");
      out.write("        });\r\n");
      out.write("\r\n");
      out.write("        initForm();\r\n");
      out.write("        \r\n");
      out.write("        $(\"#tabs\").tabs({\r\n");
      out.write("\t\t\tfit:true,\r\n");
      out.write("\t\t\tborder:false,\r\n");
      out.write("\t\t\tonSelect:function(title){\r\n");
      out.write("\t\t\t\tif(title=='柱状图' || title=='曲线图'){\r\n");
      out.write("\t\t\t\t\tsearcReceiverTourist();\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});   \r\n");
      out.write("    });//结束初始化函数\r\n");
      out.write("\r\n");
      out.write("    //--------------------初始化和公用方法 start ------------------------\r\n");
      out.write("    function initForm() {\r\n");
      out.write("      initCityList();  //加载城市列表\r\n");
      out.write("      initCountyList();//加载区县\r\n");
      out.write("      initSearchHolidyList();//加载节假日列表\r\n");
      out.write("      searcReceiverTourist(); //加载图表数据\r\n");
      out.write("      initPageEvent(); //初始化界面事件\r\n");
      out.write("     }\r\n");
      out.write("    \r\n");
      out.write("    /**\r\n");
      out.write("    * 初始化界面事件\r\n");
      out.write("    */\r\n");
      out.write("    function initPageEvent(){\r\n");
      out.write("     $(\"#btn_query\").click(function(){\r\n");
      out.write("     \t searchValidate();\r\n");
      out.write("    \t searcReceiverTourist();\r\n");
      out.write("     });\r\n");
      out.write("    }\r\n");
      out.write("    function searchValidate() {\r\n");
      out.write(" \t\t        var beginTime = document.getElementById(\"ReceiverToursitQueryForm:searchYear\").value;\r\n");
      out.write(" \t\t        \r\n");
      out.write(" \t\t        if (beginTime == \"\") {\r\n");
      out.write(" \t\t            alert(\"请选择年份！\");\r\n");
      out.write(" \t\t            return;\r\n");
      out.write(" \t\t        }\r\n");
      out.write(" \t\t        if (document.getElementById(\"ReceiverToursitQueryForm:searchHolidy\").value == \"\") {\r\n");
      out.write(" \t\t            alert(\"请选择节日！\");\r\n");
      out.write(" \t\t            return;\r\n");
      out.write(" \t\t        }\r\n");
      out.write(" \t\t        //mygrid.sendQuery();\r\n");
      out.write(" \t\t    }\r\n");
      out.write("    /**\r\n");
      out.write("    *  初始化节假日列表\r\n");
      out.write("    **/\r\n");
      out.write("    function initSearchHolidyList(){\r\n");
      out.write("    \t var cityList = document.getElementById(\"ReceiverToursitQueryForm:searchHolidy\");    \r\n");
      out.write("    \t var beloneYear =  document.getElementById(\"ReceiverToursitQueryForm:searchYear\").value;\r\n");
      out.write("    \t var queryObj = new Object();\r\n");
      out.write("    \t queryObj.beloneYear = beloneYear;\r\n");
      out.write("    \t cityList.innerHTML=\"\";\r\n");
      out.write("    \t cleanRegionSelect();\r\n");
      out.write("    \t dwr.engine.setAsync(false);\r\n");
      out.write("    \t HolidayAction.getHolidayList(queryObj,function (data) {\r\n");
      out.write("    \t\t if (null == data || null == data.returnList)return;\r\n");
      out.write("             for (var i = 0; i < data.returnList.length; i++) {\r\n");
      out.write("              var lastDate = typeof(data.returnList[i]['lastDay']) !='undefined' ?\r\n");
      out.write("            \t\t  \t\tdata.returnList[i]['lastDay'] : '';\r\n");
      out.write("              lastDate=lastDate.substring(0,'2016-03-12'.length);\r\n");
      out.write("              var optionItem = new Option(data.returnList[i]['holidayName'],lastDate);\r\n");
      out.write("              cityList.options.add(optionItem);\r\n");
      out.write("             }\r\n");
      out.write("         });\r\n");
      out.write("         dwr.engine.setAsync(true);\t\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("    /***\r\n");
      out.write("    * 初始化 城市列表\r\n");
      out.write("    **/\r\n");
      out.write("    function initCityList(){\r\n");
      out.write("    \t var cityList = document.getElementById(\"ReceiverToursitQueryForm:cityCode\");    \r\n");
      out.write("    \t dwr.engine.setAsync(false);\r\n");
      out.write("         UtilsAction.getMyCitycode(function (data) {\r\n");
      out.write("             if (null == data || null == data.returnList)return;\r\n");
      out.write("             for (var i = 0; i < data.returnList.length; i++) {\r\n");
      out.write("              //页面不需要省级排除\r\n");
      out.write("                 if (data.returnList[i]['cityid'] != '340000') {\r\n");
      out.write("                     var varItem = new Option(data.returnList[i]['name'], data.returnList[i]['cityid']);\r\n");
      out.write("                     cityList.options.add(varItem);\r\n");
      out.write("                 } \r\n");
      out.write("             }\r\n");
      out.write("         });\r\n");
      out.write("         dwr.engine.setAsync(true);\r\n");
      out.write("    }\r\n");
      out.write("    \r\n");
      out.write("    /***\r\n");
      out.write("     * 初始化区县列表\r\n");
      out.write("     **/\r\n");
      out.write("    function initCountyList(){\r\n");
      out.write("    \tvar cityid=$(\"#ReceiverToursitQueryForm\\\\:cityCode\").val();\r\n");
      out.write("    \tvar countyid=$(\"#ReceiverToursitQueryForm\\\\:countyCode\");\r\n");
      out.write("    \tvar countyCode='");
      out.print(curCountyCode);
      out.write("';\r\n");
      out.write("    \tif(countyCode==null||countyCode==\"\"||countyCode==0){\r\n");
      out.write("    \tdwr.engine.setAsync(false);\r\n");
      out.write("    \tRegionCfgAction.getAreasList(cityid,function(data){\r\n");
      out.write("    \t\tcountyid.empty();\r\n");
      out.write("    \t\tif(null==data || null==data.returnList)return;\r\n");
      out.write("    \t\tcountyid.prepend(\"<option value='0'>全部</option>\");\r\n");
      out.write("    \t\tfor (var i=0;i<data.returnList.length;i++) {\r\n");
      out.write("    \t    countyid.append(\"<option value='\"+ data.returnList[i]['areaid']+\"'>\"+ data.returnList[i]['areas'] +\"</option>\");\r\n");
      out.write("    \t\t}\r\n");
      out.write("    \t});\r\n");
      out.write("    \tdwr.engine.setAsync(true);\r\n");
      out.write("    \t}else{\r\n");
      out.write("    \t\tdwr.engine.setAsync(false);\r\n");
      out.write("\t    \tRegionCfgAction.getArea(countyCode,function(data){\r\n");
      out.write("\t    \t\tcountyid.empty();\r\n");
      out.write("\t    \t\tif(null==data || null==data.returnList)return;\r\n");
      out.write("                for (var i=0;i<data.returnList.length;i++) {\r\n");
      out.write("\t    \t    countyid.append(\"<option value='\"+ data.returnList[i]['areaid']+\"'>\"+ data.returnList[i]['areas'] +\"</option>\");\r\n");
      out.write("\t    \t\t}\r\n");
      out.write("\t    \t});\r\n");
      out.write("\t    \tdwr.engine.setAsync(true);\r\n");
      out.write("    \t}\r\n");
      out.write("    }\r\n");
      out.write("    \r\n");
      out.write("    /**\r\n");
      out.write("    * 查询结果\r\n");
      out.write("    */\r\n");
      out.write("    function searcReceiverTourist(){\r\n");
      out.write("    \tvar cityCode =document.getElementById(\"ReceiverToursitQueryForm:cityCode\").value;\r\n");
      out.write("    \tvar countyCode =document.getElementById(\"ReceiverToursitQueryForm:countyCode\").value;\r\n");
      out.write("    \tvar holidayDate =document.getElementById(\"ReceiverToursitQueryForm:searchHolidy\").value;\r\n");
      out.write("    \tvar pObject = new Object();\r\n");
      out.write("    \t  pObject.cityCode = cityCode;\r\n");
      out.write("    \t  pObject.countyCode=countyCode;\r\n");
      out.write("    \t  pObject.holidayDate = holidayDate;   \t  \r\n");
      out.write("\t\t var echars=showEChart(pObject,[],getStaticObject());\r\n");
      out.write("\t\t  //reTryChart(echars);  \r\n");
      out.write("\t\t var pObject2 = new Object();\r\n");
      out.write("\t\t pObject2.cityCode = cityCode;\r\n");
      out.write("\t\t pObject2.countyCode=countyCode;\r\n");
      out.write("   \t  \t pObject2.holidayDate = holidayDate;  \r\n");
      out.write("\t\t pObject2.IS_NOT_FETCH = \"true\";\t\t\r\n");
      out.write("\t\t showDataListTable(getStaticObject(),pObject2,[]);\r\n");
      out.write("\t\t \r\n");
      out.write("    }\r\n");
      out.write("    /**表头参数的定义*/\r\n");
      out.write("\tfunction getStaticObject(){\r\n");
      out.write("\t\tvar tObject = new Object();\r\n");
      out.write("\t\tvar caption='';\r\n");
      out.write("\t\tif($(\"#ReceiverToursitQueryForm\\\\:searchYear\").val()!=''){\r\n");
      out.write("\t\t\tcaption = $(\"#ReceiverToursitQueryForm\\\\:searchYear\").val()+'年 ';\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif($(\"#ReceiverToursitQueryForm\\\\:cityCode option:selected\").text()!=\"\"){\r\n");
      out.write("\t\t\tcaption += $(\"#ReceiverToursitQueryForm\\\\:cityCode option:selected\").text();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif($(\"#ReceiverToursitQueryForm\\\\:countyCode option:selected\").text()!=\"\"){\r\n");
      out.write("\t\t\tcaption += $(\"#ReceiverToursitQueryForm\\\\:countyCode option:selected\").text();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif($(\"#ReceiverToursitQueryForm\\\\:searchHolidy option:selected\").text()!=\"\"){\r\n");
      out.write("\t\t\tcaption += $(\"#ReceiverToursitQueryForm\\\\:searchHolidy option:selected\").text();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tcaption += '景区游客接待统计';\r\n");
      out.write("\t\t tObject.xname=\"单位（景区）\";\r\n");
      out.write("\t\t tObject.yname=\"单位（人数）\";\r\n");
      out.write("\t\t tObject.caption= caption;\r\n");
      out.write("\t \t tObject.subTitle=\"统计所有景区节假日游客数量\";\r\n");
      out.write("\t\t tObject.procedureName = \"");
      out.print(ReportConstants.HOLIDAY_RECEIVE_PROCEDURE);
      out.write("\";\r\n");
      out.write("\t\t tObject.PROC_PARAMS = \"");
      out.print(ReportConstants.HOLIDAY_RECEIVE_PROCEDURE_PARAMS);
      out.write("\";\r\n");
      out.write("\t     tObject.chartTypes = \"");
      out.print(ReportConstants.COLUMN3D_CHART);
      out.write(',');
      out.print(ReportConstants.PIE3D_CHART);
      out.write(',');
      out.print(ReportConstants.LINE2D_CHART );
      out.write("\";\r\n");
      out.write("\t\t tObject.noSplit = \"NO\";\r\n");
      out.write("\t\t return tObject;\r\n");
      out.write("\t}\r\n");
      out.write("    /**\r\n");
      out.write("    * 清除下拉框\r\n");
      out.write("    **/\r\n");
      out.write("    function cleanRegionSelect(){\r\n");
      out.write("    \t var region = document.getElementById(\"ReceiverToursitQueryForm:searchHolidy\");\r\n");
      out.write("         var length = region.options.length;\r\n");
      out.write("         if (length > 0) {\r\n");
      out.write("             for (var i = 0; i < length; i++) {\r\n");
      out.write("                 region.removeChild(region.options[region.options.length - 1]);\r\n");
      out.write("             }\r\n");
      out.write("         }\t\r\n");
      out.write("    }\r\n");
      out.write("    function reTryChart(chars){\r\n");
      out.write("\t\tfor(var i=0;i<chars.length;i++){\r\n");
      out.write("\t\t\tif(chars[i].name!='");
      out.print(ReportConstants.PIE3D_CHART);
      out.write("')\r\n");
      out.write("\t\t\t chars[i].chart.setOption({\r\n");
      out.write("\t\t\t\t xAxis : [\r\n");
      out.write("\t\t\t\t          {\r\n");
      out.write("\t\t\t\t        \t  axisLabel :{\r\n");
      out.write("\t\t\t\t        \t\t  //interval :0,\r\n");
      out.write("\t\t\t\t        \t\t // formatter: function (value, index) {\r\n");
      out.write("\t\t\t\t        \t\t\t//  return value.split('').join('\\n');\r\n");
      out.write("\t\t\t\t        \t\t\t//}\r\n");
      out.write("\t\t\t\t        \t  }\r\n");
      out.write("\t\t\t\t          }\r\n");
      out.write("\t\t\t\t          ]\t\t\t\t\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t\tchars[i].chart.resize();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("    \r\n");
      out.write("    /*\r\n");
      out.write("    * excel 导出\r\n");
      out.write("    */\r\n");
      out.write("    \r\n");
      out.write("    function exportJc()\r\n");
      out.write("\t {\r\n");
      out.write("\t\t\r\n");
      out.write("    \tvar title='';\r\n");
      out.write("    \tvar number=\"2\";\r\n");
      out.write("\t\tif($(\"#ReceiverToursitQueryForm\\\\:searchYear\").val()!=''){\r\n");
      out.write("\t\t\ttitle = $(\"#ReceiverToursitQueryForm\\\\:searchYear\").val()+'年 ';\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif($(\"#ReceiverToursitQueryForm\\\\:cityCode option:selected\").text()!=\"\"){\r\n");
      out.write("\t\t\ttitle += $(\"#ReceiverToursitQueryForm\\\\:cityCode option:selected\").text();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif($(\"#ReceiverToursitQueryForm\\\\:countyCode option:selected\").text()!=\"\"){\r\n");
      out.write("\t\t\ttitle += $(\"#ReceiverToursitQueryForm\\\\:countyCode option:selected\").text();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif($(\"#ReceiverToursitQueryForm\\\\:searchHolidy option:selected\").text()!=\"\"){\r\n");
      out.write("\t\t\ttitle += $(\"#ReceiverToursitQueryForm\\\\:searchHolidy option:selected\").text();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\ttitle += '景区游客接待统计';\r\n");
      out.write("\t\tvar headerStr = [\"景区\",\"人数\",\"开始日期\",\"结束日期\",\"假日名称\"];\r\n");
      out.write("\t    var pObject = new Object();\r\n");
      out.write("\t    \t pObject.cityCode = document.getElementById(\"ReceiverToursitQueryForm:cityCode\").value;\r\n");
      out.write("\t    \t pObject.countyCode = document.getElementById(\"ReceiverToursitQueryForm:countyCode\").value;\r\n");
      out.write("\t    \t pObject.holidayDate = document.getElementById(\"ReceiverToursitQueryForm:searchHolidy\").value;   \t     \t  \t\t\t\r\n");
      out.write("\t\t showExport(pObject,\"\",getStaticObject(),headerStr,title,number);\r\n");
      out.write("\t\t \r\n");
      out.write("\t }\r\n");
      out.write("\t\r\n");
      out.write("</script>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
